From 6aca744dd7e05800f8d800283c30ed63546b7318 Mon Sep 17 00:00:00 2001
From: Andreas Beckmann <anbe@debian.org>
Date: Tue, 10 Dec 2024 20:08:50 +0100
Subject: [PATCH] fix more uvm warnings

---
 nvidia-uvm/uvm_channel_test.c | 1 -
 nvidia-uvm/uvm_gpu.c          | 1 +
 nvidia-uvm/uvm_tools.c        | 1 +
 3 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/nvidia-uvm/uvm_channel_test.c b/nvidia-uvm/uvm_channel_test.c
index 8a3a8393..1adac345 100644
--- a/nvidia-uvm/uvm_channel_test.c
+++ b/nvidia-uvm/uvm_channel_test.c
@@ -156,7 +156,6 @@ done:
 
 static NV_STATUS test_unexpected_completed_values(uvm_va_space_t *va_space)
 {
-    NV_STATUS status;
     uvm_gpu_t *gpu;
 
     for_each_va_space_gpu(gpu, va_space) {
diff --git a/nvidia-uvm/uvm_gpu.c b/nvidia-uvm/uvm_gpu.c
index 20c9c760..4b28c17a 100644
--- a/nvidia-uvm/uvm_gpu.c
+++ b/nvidia-uvm/uvm_gpu.c
@@ -1774,6 +1774,7 @@ uvm_gpu_t *uvm_gpu_get_by_uuid(const NvProcessorUuid *gpu_uuid)
     return uvm_gpu_get_by_uuid_locked(gpu_uuid);
 }
 
+static
 uvm_gpu_t *uvm_gpu_get_by_uuid_and_swizz_id_locked(const NvProcessorUuid *gpu_uuid, NvU32 swizz_id)
 {
     uvm_parent_gpu_t *parent_gpu = uvm_parent_gpu_get_by_uuid(gpu_uuid);
diff --git a/nvidia-uvm/uvm_tools.c b/nvidia-uvm/uvm_tools.c
index f0aceaf9..68acbbff 100644
--- a/nvidia-uvm/uvm_tools.c
+++ b/nvidia-uvm/uvm_tools.c
@@ -35,6 +35,7 @@
 #include "uvm_range_group.h"
 #include "uvm_mem.h"
 #include "nv_speculation_barrier.h"
+#include "uvm_tools_init.h"
 
 // We limit the number of times a page can be retained by the kernel
 // to prevent the user from maliciously passing UVM tools the same page
-- 
2.39.5

